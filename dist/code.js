var app=function(l){"use strict";const V=()=>{try{const{sendAs:e=[]}=Gmail.Users.Settings.SendAs.list("me");if(e.length)return e.map(r=>r.sendAsEmail)}catch(e){Logger.log(e.message)}return[Session.getActiveUser().getEmail()]},R="%[a-f0-9]{2}",I=new RegExp("("+R+")|([^%]+?)","gi"),b=new RegExp("("+R+")+","gi");function S(e,r){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;r=r||1;const t=e.slice(0,r),n=e.slice(r);return Array.prototype.concat.call([],S(t),S(n))}function q(e){try{return decodeURIComponent(e)}catch{let r=e.match(I)||[];for(let t=1;t<r.length;t++)e=S(r,t).join(""),r=e.match(I)||[];return e}}function B(e){const r={"%FE%FF":"��","%FF%FE":"��"};let t=b.exec(e);for(;t;){try{r[t[0]]=decodeURIComponent(t[0])}catch{const a=q(t[0]);a!==t[0]&&(r[t[0]]=a)}t=b.exec(e)}r["%C2"]="�";const n=Object.keys(r);for(const a of n)e=e.replace(new RegExp(a,"g"),r[a]);return e}function G(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return B(e)}}function H(e,r){const t={};if(Array.isArray(r))for(const n of r){const a=Object.getOwnPropertyDescriptor(e,n);a?.enumerable&&Object.defineProperty(t,n,a)}else for(const n of Reflect.ownKeys(e)){const a=Object.getOwnPropertyDescriptor(e,n);if(a.enumerable){const i=e[n];r(n,i,e)&&Object.defineProperty(t,n,a)}}return t}function C(e,r){if(!(typeof e=="string"&&typeof r=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e===""||r==="")return[];const t=e.indexOf(r);return t===-1?[]:[e.slice(0,t),e.slice(t+r.length)]}const P=e=>e==null,Q=e=>encodeURIComponent(e).replaceAll(/[!'()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`),w=Symbol("encodeFragmentIdentifier");function k(e){switch(e.arrayFormat){case"index":return r=>(t,n)=>{const a=t.length;return n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,[c(r,e),"[",a,"]"].join("")]:[...t,[c(r,e),"[",c(a,e),"]=",c(n,e)].join("")]};case"bracket":return r=>(t,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,[c(r,e),"[]"].join("")]:[...t,[c(r,e),"[]=",c(n,e)].join("")];case"colon-list-separator":return r=>(t,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,[c(r,e),":list="].join("")]:[...t,[c(r,e),":list=",c(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const r=e.arrayFormat==="bracket-separator"?"[]=":"=";return t=>(n,a)=>a===void 0||e.skipNull&&a===null||e.skipEmptyString&&a===""?n:(a=a===null?"":a,n.length===0?[[c(t,e),r,c(a,e)].join("")]:[[n,c(a,e)].join(e.arrayFormatSeparator)])}default:return r=>(t,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,c(r,e)]:[...t,[c(r,e),"=",c(n,e)].join("")]}}function K(e){let r;switch(e.arrayFormat){case"index":return(t,n,a)=>{if(r=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),!r){a[t]=n;return}a[t]===void 0&&(a[t]={}),a[t][r[1]]=n};case"bracket":return(t,n,a)=>{if(r=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),!r){a[t]=n;return}if(a[t]===void 0){a[t]=[n];return}a[t]=[...a[t],n]};case"colon-list-separator":return(t,n,a)=>{if(r=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!r){a[t]=n;return}if(a[t]===void 0){a[t]=[n];return}a[t]=[...a[t],n]};case"comma":case"separator":return(t,n,a)=>{const i=typeof n=="string"&&n.includes(e.arrayFormatSeparator),s=typeof n=="string"&&!i&&d(n,e).includes(e.arrayFormatSeparator);n=s?d(n,e):n;const o=i||s?n.split(e.arrayFormatSeparator).map(g=>d(g,e)):n===null?n:d(n,e);a[t]=o};case"bracket-separator":return(t,n,a)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i){a[t]=n&&d(n,e);return}const s=n===null?[]:d(n,e).split(e.arrayFormatSeparator);if(a[t]===void 0){a[t]=s;return}a[t]=[...a[t],...s]};default:return(t,n,a)=>{if(a[t]===void 0){a[t]=n;return}a[t]=[...[a[t]].flat(),n]}}}function $(e){if(typeof e!="string"||e.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,r){return r.encode?r.strict?Q(e):encodeURIComponent(e):e}function d(e,r){return r.decode?G(e):e}function O(e){return Array.isArray(e)?e.sort():typeof e=="object"?O(Object.keys(e)).sort((r,t)=>Number(r)-Number(t)).map(r=>e[r]):e}function L(e){const r=e.indexOf("#");return r!==-1&&(e=e.slice(0,r)),e}function W(e){let r="";const t=e.indexOf("#");return t!==-1&&(r=e.slice(t)),r}function D(e,r,t){return t==="string"&&typeof e=="string"?e:typeof t=="function"&&typeof e=="string"?t(e):t==="boolean"&&e===null?!0:t==="boolean"&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")?e.toLowerCase()==="true":t==="boolean"&&e!==null&&(e.toLowerCase()==="1"||e.toLowerCase()==="0")?e.toLowerCase()==="1":t==="string[]"&&r.arrayFormat!=="none"&&typeof e=="string"?[e]:t==="number[]"&&r.arrayFormat!=="none"&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?[Number(e)]:t==="number"&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?Number(e):r.parseBooleans&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")?e.toLowerCase()==="true":r.parseNumbers&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?Number(e):e}function E(e){e=L(e);const r=e.indexOf("?");return r===-1?"":e.slice(r+1)}function F(e,r){r={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...r},$(r.arrayFormatSeparator);const t=K(r),n=Object.create(null);if(typeof e!="string"||(e=e.trim().replace(/^[?#&]/,""),!e))return n;for(const a of e.split("&")){if(a==="")continue;const i=r.decode?a.replaceAll("+"," "):a;let[s,o]=C(i,"=");s===void 0&&(s=i),o=o===void 0?null:["comma","separator","bracket-separator"].includes(r.arrayFormat)?o:d(o,r),t(d(s,r),o,n)}for(const[a,i]of Object.entries(n))if(typeof i=="object"&&i!==null&&r.types[a]!=="string")for(const[s,o]of Object.entries(i)){const g=r.types[a]?r.types[a].replace("[]",""):void 0;i[s]=D(o,r,g)}else typeof i=="object"&&i!==null&&r.types[a]==="string"?n[a]=Object.values(i).join(r.arrayFormatSeparator):n[a]=D(i,r,r.types[a]);return r.sort===!1?n:(r.sort===!0?Object.keys(n).sort():Object.keys(n).sort(r.sort)).reduce((a,i)=>{const s=n[i];return a[i]=s&&typeof s=="object"&&!Array.isArray(s)?O(s):s,a},Object.create(null))}function T(e,r){if(!e)return"";r={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...r},$(r.arrayFormatSeparator);const t=s=>r.skipNull&&P(e[s])||r.skipEmptyString&&e[s]==="",n=k(r),a={};for(const[s,o]of Object.entries(e))t(s)||(a[s]=o);const i=Object.keys(a);return r.sort!==!1&&i.sort(r.sort),i.map(s=>{const o=e[s];return o===void 0?"":o===null?c(s,r):Array.isArray(o)?o.length===0&&r.arrayFormat==="bracket-separator"?c(s,r)+"[]":o.reduce(n(s),[]).join("&"):c(s,r)+"="+c(o,r)}).filter(s=>s.length>0).join("&")}function U(e,r){r={decode:!0,...r};let[t,n]=C(e,"#");return t===void 0&&(t=e),{url:t?.split("?")?.[0]??"",query:F(E(e),r),...r&&r.parseFragmentIdentifier&&n?{fragmentIdentifier:d(n,r)}:{}}}function j(e,r){r={encode:!0,strict:!0,[w]:!0,...r};const t=L(e.url).split("?")[0]||"",n=E(e.url),a={...F(n,{sort:!1,...r}),...e.query};let i=T(a,r);i&&(i=`?${i}`);let s=W(e.url);if(typeof e.fragmentIdentifier=="string"){const o=new URL(t);o.hash=e.fragmentIdentifier,s=r[w]?o.hash:`#${e.fragmentIdentifier}`}return`${t}${i}${s}`}function M(e,r,t){t={parseFragmentIdentifier:!0,[w]:!1,...t};const{url:n,query:a,fragmentIdentifier:i}=U(e,t);return j({url:n,query:H(a,r),fragmentIdentifier:i},t)}function X(e,r,t){const n=Array.isArray(r)?a=>!r.includes(a):(a,i)=>!r(a,i);return M(e,n,t)}const z=Object.freeze(Object.defineProperty({__proto__:null,exclude:X,extract:E,parse:F,parseUrl:U,pick:M,stringify:T,stringifyUrl:j},Symbol.toStringTag,{value:"Module"})),_=(e,r)=>{const t=z.stringify(r,{sort:!1,arrayFormat:"bracket"});return`${e}?${t}`},Y=()=>{const t=_("https://example.com",{name:"amit",location:"india",interests:["workspace","apps script"]});Logger.log(`URL: ${t}`)},f=SpreadsheetApp.getActiveSpreadsheet(),N="Inventory",y="Transactions",x="DailyUsage",A="Recipes";function J(){try{const e=f.getSheetByName(N);if(!e)return f.insertSheet(N).appendRow(["Item Name","Unit"]),{};const r=e.getDataRange().getValues();if(r.length<2)return{};const t={};for(let n=1;n<r.length;n++)r[n][0]&&(t[r[n][0]]=r[n][1]);return t}catch(e){throw Logger.log(`Error in getMasterItems: ${e.message}`),new Error(`Could not fetch master items. Details: ${e.message}`)}}function Z(){try{const e=J(),r={};Object.keys(e).forEach(a=>{r[a]={quantity:0,unit:e[a]}});const t=f.getSheetByName(y);if(!t)return f.insertSheet(y).appendRow(["Timestamp","Item Name","Type","Quantity"]),r;const n=t.getDataRange().getValues();for(let a=1;a<n.length;a++){const[i,s,o,g]=n[a];r[s]&&!isNaN(parseFloat(g))&&(o==="IN"?r[s].quantity+=parseFloat(g):o==="OUT"&&(r[s].quantity-=parseFloat(g)))}return r}catch(e){throw Logger.log(`Error in getInventorySummary: ${e.message}`),new Error(`Could not calculate inventory summary. Details: ${e.message}`)}}function v(){try{const e=f.getSheetByName(A);if(!e)return f.insertSheet(A).appendRow(["MenuItemName","IngredientName","IngredientQuantity","IngredientUnit"]),{};const r=e.getDataRange().getValues(),t={};for(let n=1;n<r.length;n++){const[a,i,s,o]=r[n];a&&(t[a]||(t[a]=[]),i&&!isNaN(parseFloat(s))&&t[a].push({name:i,quantity:parseFloat(s),unit:o}))}return t}catch(e){throw Logger.log(`Error in getRecipes: ${e.message}`),new Error(`Could not fetch recipes. Details: ${e.message}`)}}function ee(){try{let e=f.getSheetByName(CONFIG_SHEET_NAME);e||(e=ss.insertSheet(CONFIG_SHEET_NAME),e.appendRow(["Key","Value"]),e.appendRow(["AppName","Shree Swaminarayan Gurukul Nikol"]),e.appendRow(["PrimaryColor","#f97316"]),SpreadsheetApp.flush());const r=e.getDataRange().getValues(),t={};for(let n=1;n<r.length;n++)r[n][0]&&(t[r[n][0]]=r[n][1]);return t}catch(e){return Logger.log(`Error in getAppConfig: ${e.message}`),{AppName:"Gurukul Inventory",PrimaryColor:"#f97316"}}}function re(){try{const e=Z(),r=v(),t=ee();return{inventory:e,recipes:r,config:t}}catch(e){throw Logger.log(`Error in getInitialData: ${e.message}`),new Error(`Could not fetch initial data. Details: ${e.message}`)}}function te(e,r){try{const t=f.getSheetByName(N);if(t.getRange(2,1,t.getLastRow(),1).getValues().some(a=>a[0]&&a[0].toString().toLowerCase()===e.toString().toLowerCase()))throw new Error(`Item "${e}" already exists.`);return t.appendRow([e,r]),`Successfully added ${e}.`}catch(t){throw Logger.log(`Error in addNewItem: ${t.message}`),new Error(`Could not add new master item. Details: ${t.message}`)}}function ne(){return HtmlService.createHtmlOutputFromFile("index").setTitle("Gurukul Inventory Management").addMetaTag("viewport","width=device-width, initial-scale=1.0").setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL)}function ae(e,r,t){try{if(!e||!r||!t)throw new Error("Missing transaction details.");return f.getSheetByName(y).appendRow([new Date,e,r,t]),"Transaction logged successfully."}catch(n){throw Logger.log(`Error in addTransaction: ${n.message}`),new Error(`Could not log transaction. Details: ${n.message}`)}}function se(e){try{const{name:r,ingredients:t}=e;if(!r||!t||t.length===0)throw new Error("Invalid recipe data.");const n=f.getSheetByName(A);if(n.getRange(2,1,n.getLastRow(),1).getValues().flat().some(s=>s.toString().toLowerCase()===r.toString().toLowerCase()))throw new Error(`A menu item named "${r}" already exists.`);const i=t.map(s=>[r,s.name,s.quantity,s.unit]);return n.getRange(n.getLastRow()+1,1,i.length,i[0].length).setValues(i),Logger.log(`Added recipe for ${r}`),`Recipe for "${r}" saved successfully.`}catch(r){throw Logger.log(`Error in addRecipe: ${r.message}`),new Error(`Could not save recipe. Details: ${r.message}`)}}function ie(e){try{const{date:r,meal:t,people:n,cookedItems:a,wasteItems:i}=e;if(!r||!t||!n)throw new Error("Incomplete report data provided.");const s=new Date,o=SpreadsheetApp.getActiveSpreadsheet();let g=f.getSheetByName(x);g||(g=f.insertSheet(x),g.appendRow(["Timestamp","Date","MealType","PeopleServed","ItemName","Quantity","Unit","Type"]));let h=f.getSheetByName(y);h||(h=f.insertSheet(y),h.appendRow(["Timestamp","Item Name","Type","Quantity"]));const m=[],p=[];return a.forEach(u=>{m.push([s,r,t,n,u.name,u.servings,"servings","Usage"])}),i.forEach(u=>{m.push([s,r,t,n,u.name,u.quantity,u.unit,"Waste"]),p.push([s,u.name,"OUT",u.quantity])}),m.length>0&&g.getRange(g.getLastRow()+1,1,m.length,m[0].length).setValues(m),p.length>0&&h.getRange(h.getLastRow()+1,1,p.length,p[0].length).setValues(p),"Report logged successfully."}catch(r){throw Logger.log(`Error in logDailyUsage: ${r.message}`),new Error(`Could not log daily report. Details: ${r.message}`)}}return l.addNewItem=te,l.addRecipe=se,l.addTransaction=ae,l.createQueryString=_,l.doGet=ne,l.getGmailAliases=V,l.getInitialData=re,l.logDailyUsage=ie,l.makeQueryString=Y,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),l}({});

const addNewItem = (...args) => app.addNewItem(...args);
const addRecipe = (...args) => app.addRecipe(...args);
const addTransaction = (...args) => app.addTransaction(...args);
const createQueryString = (...args) => app.createQueryString(...args);
const doGet = (...args) => app.doGet(...args);
const getGmailAliases = (...args) => app.getGmailAliases(...args);
const getInitialData = (...args) => app.getInitialData(...args);
const logDailyUsage = (...args) => app.logDailyUsage(...args);
const makeQueryString = (...args) => app.makeQueryString(...args);